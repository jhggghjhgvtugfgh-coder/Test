<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antigravity Python</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.12.0/brython.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.12.0/brython_stdlib.js"></script>
    <style>
        body, html { 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            background-color: #0d0d0d; /* Dark background */
            width: 100%;
            height: 100%;
        }
        canvas { 
            display: block; 
        }
    </style>
</head>
<body onload="brython()">

<canvas id="antigravityCanvas"></canvas>

<script type="python">
from browser import document, window, timer
import math
import random

canvas = document["antigravityCanvas"]
ctx = canvas.getContext("2d")

# Initialize dimensions
def resize(ev=None):
    canvas.width = window.innerWidth
    canvas.height = window.innerHeight

window.bind("resize", resize)
resize()

# Logic Settings
CONFIG = {
    'count': 250,
    'magnetRadius': 120,
    'ringRadius': 70,
    'lerpSpeed': 0.08,
    'color': '#FF9FFC',
    'waveSpeed': 2.0,
    'waveAmplitude': 15
}

mouse = {'x': canvas.width / 2, 'y': canvas.height / 2}
particles = []

class Particle:
    def __init__(self):
        self.mx = random.uniform(0, canvas.width)
        self.my = random.uniform(0, canvas.height)
        self.cx, self.cy = self.mx, self.my
        self.t = random.random() * 100
        self.speed = 0.02 + random.random() / 50
        self.radius_offset = (random.random() - 0.5) * 20

    def update(self):
        self.t += self.speed
        
        dx = self.mx - mouse['x']
        dy = self.my - mouse['y']
        dist = math.sqrt(dx*dx + dy*dy)

        target_x, target_y = self.mx, self.my

        if dist < CONFIG['magnetRadius']:
            angle = math.atan2(dy, dx)
            # Add a bit of rotation to the angle over time
            angle += self.t * 0.2 
            
            wave = math.sin(self.t * CONFIG['waveSpeed']) * CONFIG['waveAmplitude']
            current_ring = CONFIG['ringRadius'] + wave + self.radius_offset
            
            target_x = mouse['x'] + math.cos(angle) * current_ring
            target_y = mouse['y'] + math.sin(angle) * current_ring

        # Smooth interpolation
        self.cx += (target_x - self.cx) * CONFIG['lerpSpeed']
        self.cy += (target_y - self.cy) * CONFIG['lerpSpeed']

    def draw(self):
        ctx.fillStyle = CONFIG['color']
        ctx.beginPath()
        # Draw small rectangles to mimic the "capsule" look from your React code
        ctx.save()
        ctx.translate(self.cx, self.cy)
        ctx.rotate(self.t)
        ctx.fillRect(-1, -3, 2, 6)
        ctx.restore()

# Create particle instances
for _ in range(CONFIG['count']):
    particles.append(Particle())

def on_mouse_move(ev):
    mouse['x'] = ev.clientX
    mouse['y'] = ev.clientY

document.bind("mousemove", on_mouse_move)
# Also bind touch for mobile users
document.bind("touchmove", lambda ev: on_mouse_move(ev.touches[0]))

def animate(time):
    ctx.clearRect(0, 0, canvas.width, canvas.height)
    
    for p in particles:
        p.update()
        p.draw()
        
    window.requestAnimationFrame(animate)

# Start animation
window.requestAnimationFrame(animate)
</script>
</body>
</html>
